<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª</title>

<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-messaging-compat.js"></script>

<style>
body{
font-family:Arial;
text-align:center;
padding:40px;
background:#111;
color:#fff;
}
button{
padding:15px 30px;
font-size:18px;
border:none;
border-radius:10px;
cursor:pointer;
background:#00c853;
color:white;
}
#log{
margin-top:30px;
background:#000;
padding:15px;
border-radius:10px;
text-align:left;
white-space:pre-line;
}
</style>
</head>
<body>

<h1>ðŸ”” Ø§Ø®ØªØ¨Ø§Ø± Firebase Notifications</h1>

<button onclick="startTest()">ØªØ´ØºÙŠÙ„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</button>

<div id="log">Logs:\n</div>

<script>
function log(msg){
document.getElementById("log").innerHTML += msg + "\n";
}

/* Firebase config */
const firebaseConfig = {
  apiKey: "PUT_APIKEY",
  authDomain: "PUT_DOMAIN",
  projectId: "PUT_PROJECTID",
  messagingSenderId: "PUT_SENDERID",
  appId: "PUT_APPID"
};

firebase.initializeApp(firebaseConfig);
const messaging = firebase.messaging();

async function startTest(){

log("Ø¨Ø¯Ø¡ Ø§Ù„ÙØ­Øµ...");

/* ÙØ­Øµ Ø§Ù„Ù…ØªØµÙØ­ */
if(!("Notification" in window)){
log("âŒ Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª");
return;
}

log("âœ” Ø§Ù„Ù…ØªØµÙØ­ ÙŠØ¯Ø¹Ù… Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª");

/* Ø·Ù„Ø¨ Ø¥Ø°Ù† */
const permission = await Notification.requestPermission();
log("Permission: " + permission);

if(permission !== "granted"){
log("âŒ Ù„Ù… ÙŠØªÙ… Ù…Ù†Ø­ Ø§Ù„Ø¥Ø°Ù†");
return;
}

/* ØªØ³Ø¬ÙŠÙ„ SW */
try{
const reg = await navigator.serviceWorker.register("firebase-messaging-sw.js");
log("âœ” Service Worker registered");
}catch(e){
log("âŒ SW error: " + e);
return;
}

/* Ø¬Ù„Ø¨ ØªÙˆÙƒÙ† */
try{
const token = await messaging.getToken({
vapidKey:"PUT_VAPID_KEY",
serviceWorkerRegistration: await navigator.serviceWorker.ready
});

if(token){
log("âœ… TOKEN:");
log(token);
}else{
log("âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ØªÙˆÙƒÙ†");
}
}catch(err){
log("âŒ Token Error:");
log(err);
}

/* Ø§Ø®ØªØ¨Ø§Ø± Ø¥Ø´Ø¹Ø§Ø± Ù…Ø¨Ø§Ø´Ø± */
new Notification("Ù†Ø¬Ø­ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ðŸŽ‰",{
body:"Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ØªØ¹Ù…Ù„ Ø¨Ù†Ø¬Ø§Ø­"
});

}

messaging.onMessage(payload=>{
log("ðŸ“© Ø¥Ø´Ø¹Ø§Ø± ÙˆØ§Ø±Ø¯:");
log(JSON.stringify(payload));
});
</script>

</body>
</html>
